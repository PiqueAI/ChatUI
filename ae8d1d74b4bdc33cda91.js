import"./global.css";import"./index.css";document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".button"),t=document.querySelector(".delete-chat-history"),s=document.querySelectorAll(".minimize-button"),n=document.querySelectorAll(".minimize-button1"),o=document.querySelector(".welcome-page"),i=document.querySelector(".chat-page"),a=document.querySelectorAll(".message-1, .message-2, .message-3, .message-4, .message-5, .message-6, .message-7"),c=document.querySelector(".inquiries-button"),l=document.querySelector(".send-button"),d=document.querySelector(".text-field"),r=document.querySelector(".message-window");let u=!1,m=!0,p=null,y={"message-1":!1,"message-2":!1,"message-3":!1,"message-4":!1,"message-5":!1,"message-6":!1,"message-7":!1};var f={"message-1":[],"message-2":[],"message-3":[],"message-4":[],"message-5":[],"message-6":[],"message-7":[]};const g={"message-1":"https://flowise.piqueai.com.au/api/v1/prediction/f7f62a8e-592e-4402-8645-10e55f4b902c","message-2":"https://flowise.piqueai.com.au/api/v1/prediction/f1538ba8-090b-4502-9830-89bf2469ab89","message-3":"https://flowise.piqueai.com.au/api/v1/prediction/0aee71d0-9d83-4037-b35a-c74475cbb23c","message-4":"https://flowise.piqueai.com.au/api/v1/prediction/92f81990-97b7-42cb-baa7-a77f3f295f7e","message-5":"https://flowise.piqueai.com.au/api/v1/prediction/957ed416-c3c6-479f-aee4-aadd6e38e96c","message-6":"","message-7":""};async function h(e,t,s,n){const o={question:t,overrideConfig:{sessionId:function(){let e=localStorage.getItem("sessionId");return e||(e="TEST-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),localStorage.setItem("sessionId",e)),e}()}};try{const t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),a=await t.json();if(p===s&&"flex"===i.style.display)I(a.text,"bot",s);else{const e=k();f[s].push({type:"bot",text:a.text,timestamp:e}),q()}n&&n()}catch(e){console.error("Error querying the bot:",e);const t="Sorry, there was an error communicating with the bot.";p===s&&"flex"===i.style.display?I(t,"bot",s):(f[s].push({type:"bot",text:t}),q()),n&&n()}}var b,S={};function q(){let e=0;for(const t in f){const s=f[t].length,n=document.querySelector(`.${t} .notification-icon`),o=n.querySelector(".unread-message-count");s>0?(n.style.display="flex",o.textContent=s,e+=s):n.style.display="none"}document.querySelector(".notification-icon-minimized").style.display=e>0?"flex":"none"}function v(){o.style.display="none",i.style.display="flex",m=!1}function x(){const e=this.className.split(" ")[0];if(y[e])p=e,L(),w(p);else{const t=this.querySelector(".question").textContent;p=e,L(),w(p),I(t,"user",p),h(g[e],t,e).then((e=>{})),y[e]=!0}u=!0,v(),E(p)}function E(e){p=e,L(),w(p),function(e){f[e].length>0&&(f[e].forEach((t=>{I(t.text,t.type,e,t.timestamp)})),f[e]=[])}(p),q()}function w(e){S[e]&&S[e].forEach((t=>{I(t.text,t.type,e,t.timestamp,!1)}))}function L(){r.innerHTML=""}function C(){const e=d.value.trim();e&&(I(e,"user",p),d.value="",l.disabled=!0,d.disabled=!0,p&&g[p])&&h(g[p],e,p,(()=>{l.disabled=!1,d.disabled=!1,d.focus()}))}function k(){const e=new Date;let t=e.getHours(),s=e.getMinutes(),n=t>=12?"pm":"am";return t%=12,t=t||12,s=s<10?"0"+s:s,t+":"+s+" "+n}function I(e,t,s,n=null,o=!0){const i=document.createElement("div"),a="user"===t?"user-message-window":"bot-message-window",c=r.querySelector("."+a+":last-child");let l;n||(n=k());const d=document.createElement("div");d.classList.add("am"),c&&c.classList.contains(t+"-message")?l=c:(l=document.createElement("div"),l.classList.add(a),d.textContent=n,l.appendChild(d),r.appendChild(l)),i.classList.add(t+"-message");const u=document.createElement("div");u.textContent=e,i.appendChild(u),l.appendChild(i),r.scrollTop=r.scrollHeight,o&&s&&(S[s]||(S[s]=[]),S[s].push({type:t,text:e,timestamp:n}),localStorage.setItem("chatHistories",JSON.stringify(S)))}t.addEventListener("click",(function(){p&&S[p]&&(delete S[p],localStorage.setItem("chatHistories",JSON.stringify(S)),L())})),e.addEventListener("click",(function(){!1===m?(o.style.display="none",i.style.display="none",m=!0):u&&m?(o.style.display="none",i.style.display="flex",m=!1,E(p)):(o.style.display="flex",i.style.display="none",m=!1)})),s.forEach((e=>e.addEventListener("click",(function(){o.style.display="none",i.style.display="none",m=!0})))),n.forEach((e=>e.addEventListener("click",(function(){o.style.display="flex",i.style.display="none",m=!1})))),a.forEach((e=>e.addEventListener("click",x))),c.addEventListener("click",(function(){u=!0,v()})),l.addEventListener("click",C),d.addEventListener("keypress",(function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),C())})),o.style.display="none",i.style.display="none",(b=localStorage.getItem("chatHistories"))&&(S=JSON.parse(b))}));